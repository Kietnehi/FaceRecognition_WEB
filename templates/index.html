<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Recognition & Analysis System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé≠ H·ªÜ TH·ªêNG NH·∫¨N DI·ªÜN & PH√ÇN T√çCH KHU√îN M·∫∂T</h1>
            <p class="subtitle">Face Recognition & DeepFace Analysis</p>
        </header>

        <!-- Environment Status -->
        <div class="env-status-section">
            <h2>üìä Tr·∫°ng th√°i m√¥i tr∆∞·ªùng</h2>
            <div class="env-status-cards">
                <div class="env-card" id="env-face-recognition">
                    <h3>Face Recognition</h3>
                    <div class="status-indicator">
                        <span class="status-dot"></span>
                        <span class="status-text">ƒêang ki·ªÉm tra...</span>
                    </div>
                    <button class="btn-setup" onclick="setupEnvironment('face_recognition')">Thi·∫øt l·∫≠p</button>
                </div>
                <div class="env-card" id="env-deepface">
                    <h3>DeepFace</h3>
                    <div class="status-indicator">
                        <span class="status-dot"></span>
                        <span class="status-text">ƒêang ki·ªÉm tra...</span>
                    </div>
                    <button class="btn-setup" onclick="setupEnvironment('deepface_recognition')">Thi·∫øt l·∫≠p</button>
                </div>
            </div>
        </div>

        <!-- Main Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('face-recognition')">
                üë§ Nh·∫≠n Di·ªán Khu√¥n M·∫∑t
            </button>
            <button class="tab-btn" onclick="showTab('deepface')">
                üîç Ph√¢n T√≠ch DeepFace
            </button>
        </div>

        <!-- Face Recognition Tab -->
        <div id="face-recognition-tab" class="tab-content active">
            <div class="content-grid">
                <!-- Register Section -->
                <div class="card">
                    <h2>üìù ƒêƒÉng k√Ω khu√¥n m·∫∑t</h2>
                    <div class="input-group">
                        <label for="user-name">T√™n ng∆∞·ªùi d√πng:</label>
                        <input type="text" id="user-name" placeholder="Nh·∫≠p t√™n...">
                    </div>
                    <video id="register-video" autoplay></video>
                    <canvas id="register-canvas" style="display:none;"></canvas>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="startRegisterCamera()">üì∑ B·∫≠t Camera</button>
                        <button class="btn btn-success" onclick="captureRegister()">‚úì Ch·ª•p & L∆∞u</button>
                        <button class="btn btn-danger" onclick="stopRegisterCamera()">‚úï T·∫Øt Camera</button>
                    </div>
                    <div id="register-status" class="status-message"></div>
                    <div class="registered-users">
                        <h3>Danh s√°ch ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng k√Ω:</h3>
                        <ul id="user-list"></ul>
                    </div>
                </div>

                <!-- Recognition Section -->
                <div class="card">
                    <h2>üîé Nh·∫≠n di·ªán khu√¥n m·∫∑t (Realtime)</h2>
                    <div class="video-container">
                        <video id="recognize-video" autoplay></video>
                        <canvas id="recognize-canvas"></canvas>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="startRecognizeCamera()">üì∑ B·∫≠t Camera & Nh·∫≠n Di·ªán</button>
                        <button class="btn btn-danger" onclick="stopRecognizeCamera()">‚úï T·∫Øt Camera</button>
                    </div>
                    <div id="recognize-result" class="result-box"></div>
                </div>
            </div>
        </div>

        <!-- DeepFace Tab -->
        <div id="deepface-tab" class="tab-content">
            <div class="card card-large">
                <h2>üß† Ph√¢n t√≠ch DeepFace</h2>
                <p class="description">Ph√¢n t√≠ch tu·ªïi, gi·ªõi t√≠nh, c·∫£m x√∫c v√† nh√≥m d√¢n t·ªôc t·ª´ khu√¥n m·∫∑t</p>
                
                <!-- Upload/Paste Area -->
                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">üì∑</div>
                    <p class="upload-text">K√©o th·∫£ ·∫£nh v√†o ƒë√¢y, ho·∫∑c nh·∫•n ƒë·ªÉ ch·ªçn file</p>
                    <p class="upload-hint">Ho·∫∑c nh·∫•n Ctrl+V ƒë·ªÉ paste ·∫£nh t·ª´ clipboard</p>
                    <input type="file" id="image-upload" accept="image/*" style="display:none;">
                </div>
                
                <!-- Preview Area -->
                <div id="image-preview-container" style="display:none;">
                    <img id="image-preview" alt="Preview">
                    <button class="btn btn-danger btn-small" onclick="clearImage()">‚úï X√≥a ·∫£nh</button>
                </div>
                
                <canvas id="deepface-canvas" style="display:none;"></canvas>
                
                <div class="button-group">
                    <button class="btn btn-success" onclick="analyzeFaceFromImage()">üî¨ Ph√¢n T√≠ch</button>
                </div>
                
                <div id="deepface-result" class="deepface-result"></div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-text">ƒêang x·ª≠ l√Ω...</p>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
